ssh-proxy-config
================

Generate SSH configuration for accessing hosts inside a VPC.

**ssh-proxy-config** supports the following cloud providers:

* `Amazon EC2 <https://aws.amazon.com/ec2/>`_
* `VM Farms <https://vmfarms.com/>`_

Usage
-----

Configurations generated by **ssh-proxy-config** tell SSH to connect to all
hosts through a bastion host. This uses SSH's ``ProxyCommand`` feature.

The default bastion host is the first host whose hostname contains "``proxy``".

For example, running:

.. code-block:: bash

    export VMFARMS_API_TOKEN='your VM Farms token'
    ssh-proxy-config

will output something like::

    User deploy

    Host prod-proxy-01
      HostName 203.0.113.44

    Host stage-app01
      Hostname 172.16.0.9
      ProxyCommand ssh -q -A -x prod-proxy-01 -W %h:22

    Host prod-app02
      Hostname 172.16.0.2
      ProxyCommand ssh -q -A -x prod-proxy-01 -W %h:22

    Host prod-db01
      Hostname 172.16.0.6
      ProxyCommand ssh -q -A -x prod-proxy-01 -W %h:22


Specify the bastion host to use with ``-b``/``--bastion``:

.. code-block:: bash

    ssh-proxy-config -b stage-proxy01

Generate a configuration using a different user than ``deploy`` using ``-u``/``--user``:

.. code-block:: bash

    ssh-proxy-config -u alice

Providers
---------

Amazon EC2
^^^^^^^^^^

**ssh-proxy-config** uses `boto3 <https://boto3.readthedocs.org/en/latest/>`_ to query EC2.

.. code-block:: bash

    ssh-proxy-config ec2

**boto3** will try to find your AWS credentials several locations; refer to the `documentation <https://boto3.readthedocs.org/en/latest/guide/quickstart.html#configuration>`_ for details.

VM Farms
^^^^^^^^

Provide your VM Farms API token as the ``VMFARMS_API_TOKEN`` environment variable:

.. code-block:: bash

    export VMFARMS_API_TOKEN='your VM Farms token'
    ssh-proxy-config

Installation
------------

Install the pre-release version from GitHub:

.. code-block:: bash

    pip install git+https://github.com/vmfarms/ssh-proxy-config.git@v0.1.0#egg=ssh-proxy-config

Compatibility
-------------

* Python 2.7
* Python 3.4
* Python 3.5

Licence
-------

Apache 2.0

Authors
-------

**ssh-proxy-config** was written by `VM Farms Inc. <ops@vmfarms.com>`_.
